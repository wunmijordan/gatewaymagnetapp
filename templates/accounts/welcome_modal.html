{% load static %}
<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Gateway Magnet{% endblock %}</title>

  <!-- PWA manifest and theme color -->
  <link rel="manifest" href="{% static 'manifest.json' %}">
  <meta name="theme-color" content="#2e303e">

  <!-- Apple support -->
  <link rel="apple-touch-icon" href="{% static 'images/icons/icon-192x192.png' %}">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <link rel="icon" type="image/png" sizes="192x192" href="{% static 'images/icons/icon-192x192.png' %}">
  <link rel="icon" type="image/png" sizes="512x512" href="{% static 'images/icons/icon-512x512.png' %}">
  <link rel="icon" type="image/png" sizes="512x512" href="{% static 'images/icons/icon-512x512-maskable.png' %}">

  <!-- CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/@tabler/icons-webfont/tabler-icons.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
  <link href="{% static 'css/custom.css' %}" rel="stylesheet" />
  <style>
    body {
      background: url("{% static 'images/church_logo.png' %}") no-repeat center center fixed;
      background-size: contain;
      height: 100vh;
    }

    .modal-backdrop.show {
      opacity: 0.9;
    }
  </style>
</head>

<body>
  <!-- Fullscreen overlay -->
  <div class="modal fade show d-block" id="dailyWelcomeModal" tabindex="-1" aria-hidden="false" style="background-color: rgba(0,0,0,0.8);">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header bg-dark text-success">
          <h1 class="modal-title text-center">Hello there!
            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-thumb-up">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M7 11v8a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-7a1 1 0 0 1 1 -1h3a4 4 0 0 0 4 -4v-1a2 2 0 0 1 4 0v5h3a2 2 0 0 1 2 2l-1 5a2 3 0 0 1 -2 2h-7a3 3 0 0 1 -3 -3" />
            </svg>
          </h1>
        </div>
        <div class="modal-body text-center">
          <div>
            <p><strong>{{ day_name }} {{ time_str }}</strong></p>
            <p class="text-warning mt-3 mb-3"><em><q>{{ quote }}</q></em></p>
            <p>Welcome back to doing the LORD'S Work! <br>Are you here to check on a Kingdom Recruit or to enlist another?<br></p>
          </div>

          <!-- Spinner + countdown -->
          <div class="d-flex flex-column align-items-center">
            <div class="spinner-border text-success mb-2" role="status"></div>
            <small class="text-muted">Redirecting in <span id="countdown">5</span> seconds...</small>
          </div>
        </div>

        <div class="modal-footer d-flex justify-content-between mt-4">
          <a href="{{ dashboard_url }}" id="dashboard-link" class="btn btn-grey">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-1">
              <path d="M5 12l-2 0l9 -9l9 9l-2 0"></path>
              <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
              <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
            </svg>
            {{ dashboard_label }}
          </a>
          <a href="{% url 'create_guest' %}" class="btn btn-success">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-users">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
              <path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
              <path d="M16 3.13a4 4 0 0 1 0 7.75" />
              <path d="M21 21v-2a4 4 0 0 0 -3 -3.85" />
            </svg>
            Add New Guest
          </a>
        </div>
      </div>
    </div>
  </div>
  <!-- Backdrop -->
  <div class="modal-backdrop fade show"></div>

  <script>
    // Auto redirect after 5 seconds
    let countdown = 5;
    const countdownEl = document.getElementById("countdown");
    const dashboardLink = document.getElementById("dashboard-link").href;

    const timer = setInterval(() => {
      countdown--;
      countdownEl.textContent = countdown;
      if (countdown <= 0) {
        clearInterval(timer);
        window.location.href = dashboardLink;
      }
    }, 1000);
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Your custom JS -->
  <script src="{% static 'js/custom.js' %}"></script>
</body>
</html>
